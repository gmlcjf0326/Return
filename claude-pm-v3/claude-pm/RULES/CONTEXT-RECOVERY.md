# 🔄 컨텍스트 복구 규칙 (CONTEXT-RECOVERY)

> 세션이 끊겨도 즉시 작업을 이어갈 수 있는 시스템

---

## 🎯 핵심 원칙

```
세션 끊김 = 컨텍스트 손실
해결책 = 모든 컨텍스트를 문서에 기록

문서만 읽으면 → 즉시 이어서 작업 가능
```

---

## 📋 복구 프로토콜

### 새 세션 시작 시 (3단계)

```
┌─────────────────────────────────────────────────┐
│  Step 1: CLAUDE.md 읽기 (30초)                  │
│  → 프로젝트 개요, 현재 상태, 작업 규칙 파악     │
├─────────────────────────────────────────────────┤
│  Step 2: PROGRESS.md 읽기 (30초)                │
│  → 전체 진행률, 현재 진행 중인 태스크 확인      │
├─────────────────────────────────────────────────┤
│  Step 3: 현재 TASK 폴더 읽기 (1분)              │
│  → 세부 작업 내용, 마지막 작업 지점 파악        │
└─────────────────────────────────────────────────┘

총 소요: 약 2분 → 바로 작업 재개
```

---

## 📁 필수 문서 구조

### CLAUDE.md (프로젝트 루트)
```markdown
# [프로젝트명]

## 📌 한 줄 요약
[이 프로젝트가 무엇인지 한 문장으로]

## 🎯 현재 상태
- 진행률: XX%
- 현재 작업: TASK-XXX [태스크명]
- 마지막 업데이트: YYYY-MM-DD

## 🔄 새 세션 시작 시
1. 이 파일 읽기 ✓
2. `docs/PROGRESS.md` 읽기
3. 🚀 표시된 태스크 폴더 읽기
4. 이어서 작업

## 📁 주요 경로
| 문서 | 경로 |
|------|------|
| 진행현황 | `docs/PROGRESS.md` |
| 태스크 | `docs/TASKS/` |
| 아키텍처 | `docs/ARCHITECTURE.md` |

## ⚙️ 작업 규칙 요약
- 코드 파일 200줄 이하 (원칙)
- 태스크 시작 시 🚀, 완료 시 ✅
- 변경 사항은 즉시 문서 반영
```

### PROGRESS.md (docs/)
```markdown
# 📊 진행 현황

> 최종 업데이트: YYYY-MM-DD HH:MM

## 전체 진행률
████████░░░░░░░░░░░░░░░░░░░░░░ 27% (8/30)

## 🚀 현재 작업 중
- **TASK-009**: 결제 API 연동
  - 현재: 9-2 Stripe 연동 중
  - 📁 `docs/TASKS/TASK-009/`

---

## Phase 1: 기반 구축 ✅
- [x] TASK-001: 프로젝트 설정 ✅
- [x] TASK-002: DB 스키마 설계 ✅
- [x] TASK-003: 인증 시스템 ✅

## Phase 2: 핵심 기능 🚀
- [x] TASK-004: 사용자 CRUD ✅
- [x] TASK-005: 상품 CRUD ✅
- [x] TASK-006: 장바구니 ✅
- [x] TASK-007: 주문 시스템 ✅
- [x] TASK-008: 주문 내역 ✅
- [ ] TASK-009: 결제 API 🚀  ← 현재
- [ ] TASK-010: 결제 확인 ⏳

## Phase 3: 부가 기능 ⏳
- [ ] TASK-011 ~ TASK-020
```

---

## 📝 작업 중 기록 규칙

### 1. 작업 시작 시
```markdown
# docs/TASKS/TASK-009/README.md

## 🚀 현재 진행 상황
- 시작일: 2026-01-10
- 현재 서브태스크: 9-2 Stripe 연동
- 마지막 작업: `src/payments/stripe.js` 생성 중

## 진행 중인 작업 상세
- Stripe SDK 설치 완료
- 기본 설정 완료
- 결제 Intent 생성 함수 구현 중 (50% 완료)
```

### 2. 중요 결정 시
```markdown
# docs/DECISIONS.md에 추가

## [2026-01-10] 결제 시스템 선택
- **결정**: Stripe 사용
- **이유**: 문서화 우수, 한국 지원, 테스트 모드 제공
- **대안**: 토스페이먼츠 (추후 추가 가능)
```

### 3. 막혔을 때
```markdown
# PROGRESS.md 해당 태스크에 표시

- [ ] TASK-009: 결제 API 🔥
  - 🔥 블로커: Stripe API 키 필요
  - 요청: 사용자에게 API 키 요청함
```

---

## 🔍 복구 시 확인 체크리스트

```markdown
## 세션 복구 체크리스트

### 1. 프로젝트 상태 파악
- [ ] CLAUDE.md에서 현재 상태 확인
- [ ] 진행률 확인 (XX%)
- [ ] 현재 진행 중인 태스크 확인

### 2. 작업 컨텍스트 파악
- [ ] PROGRESS.md에서 🚀 태스크 찾기
- [ ] 해당 TASK 폴더의 README.md 읽기
- [ ] 마지막 작업 파일/함수 확인

### 3. 작업 재개
- [ ] 중단 지점부터 이어서 작업
- [ ] 필요시 ARCHITECTURE.md 참조
- [ ] 필요시 DECISIONS.md 참조
```

---

## 📋 복구 후 보고 형식

세션 복구 후 사용자에게 보고:

```markdown
## 🔄 세션 복구 완료

**프로젝트**: [프로젝트명]
**진행률**: 27% (8/30 태스크)

**현재 작업**:
- TASK-009: 결제 API 연동
- 서브태스크: 9-2 Stripe 연동
- 마지막 작업: `stripe.js` - createPaymentIntent 함수 구현 중

**이어서 진행할까요?**
```

---

## ⚠️ 컨텍스트 손실 방지 원칙

### DO ✅
```
- 작업 시작/종료 시 문서 즉시 업데이트
- 중요한 결정은 DECISIONS.md에 기록
- 막히면 블로커로 명시
- 진행 상황 체크박스 실시간 업데이트
```

### DON'T ❌
```
- 여러 태스크 동시 진행 (추적 어려움)
- 문서 업데이트 미루기
- 머릿속으로만 기억하기
- 임시 코드 기록 없이 작성
```
