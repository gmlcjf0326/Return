# 기술 결정 기록 (ADR - Architecture Decision Records)

> **프로젝트**: ReMemory
> **목적**: 주요 기술 결정과 그 이유를 기록하여 나중에 "왜 이렇게 했지?" 질문에 답변

---

## 결정 목록

| ID | 날짜 | 제목 | 상태 |
|----|------|------|------|
| ADR-001 | 2025-01-14 | 인증 없음 - 세션 기반 | 채택 |
| ADR-002 | 2025-01-14 | Prisma 5 사용 | 채택 |
| ADR-003 | 2025-01-14 | 개발 DB - SQLite | 채택 |

---

## ADR-001: 인증 없음 - 세션 기반

### 날짜
2025-01-14

### 컨텍스트
회상치료 플랫폼의 사용자 인증 방식을 결정해야 함.
- 대상 사용자: 조기치매/MCI 고령자
- POC(Proof of Concept) 단계
- 복잡한 로그인 과정은 고령자에게 접근성 장벽

### 고려한 옵션들

#### 옵션 A: 전통적인 로그인 (이메일/비밀번호)
- **장점**: 보안성 높음, 다중 기기 지원
- **단점**: 고령자 접근성 저하, 비밀번호 분실 문제

#### 옵션 B: 소셜 로그인 (Google, Kakao)
- **장점**: 비밀번호 관리 불필요
- **단점**: 계정 연동 필요, 고령자 친숙도 낮음

#### 옵션 C: UUID 세션 + LocalStorage
- **장점**: 접근성 최고, 즉시 사용 가능
- **단점**: 브라우저 데이터 삭제 시 세션 분실

### 결정
**옵션 C (UUID 세션)** 선택

### 이유
1. **고령자 접근성**: 로그인 과정 없이 즉시 사용 가능
2. **POC 목적**: 빠른 프로토타이핑 우선
3. **의료기관 사용 시나리오**: 담당자가 기기 관리

### 트레이드오프
- 브라우저 데이터 삭제 시 이력 분실 가능
- 다중 기기 동기화 불가

### 향후 고려사항
- 정식 버전에서 보호자/의료진 계정 추가 검토
- QR 코드 기반 세션 복구 기능 고려

---

## ADR-002: Prisma 버전 선택

### 날짜
2025-01-14

### 컨텍스트
ORM으로 Prisma 사용 결정 후, 버전 선택 필요.
- Prisma 7: 최신 버전, 새로운 설정 방식
- Prisma 5: 안정 버전

### 고려한 옵션들

#### 옵션 A: Prisma 7 (최신)
- **장점**: 최신 기능, 장기 지원
- **단점**: Breaking changes, 새로운 설정 방식 학습 필요

#### 옵션 B: Prisma 5 (안정)
- **장점**: 안정성, 풍부한 문서/예제
- **단점**: 일부 최신 기능 미지원

### 결정
**Prisma 5** 선택

### 이유
1. **안정성**: 검증된 버전, 예상치 못한 오류 최소화
2. **문서화**: 풍부한 예제와 커뮤니티 지원
3. **POC 우선**: 빠른 개발이 최신 기능보다 중요

### 트레이드오프
- Prisma 7의 새로운 기능 미사용
- 향후 마이그레이션 필요 가능성

---

## ADR-003: 개발 환경 DB - SQLite

### 날짜
2025-01-14

### 컨텍스트
개발 환경에서 Prisma Postgres 연결 실패 (P5010 Error).
- `prisma dev` 미실행 또는 연결 문제
- 외부 DB 없이 즉시 개발 필요

### 고려한 옵션들

#### 옵션 A: Prisma Postgres 디버깅
- **장점**: 배포 환경과 동일한 DB
- **단점**: 설정 복잡, 개발 지연

#### 옵션 B: SQLite (로컬 파일 DB)
- **장점**: 설치 불필요, 즉시 사용 가능
- **단점**: PostgreSQL 전용 기능 미지원

#### 옵션 C: Docker로 PostgreSQL 실행
- **장점**: 배포 환경과 동일
- **단점**: Docker 설치/관리 필요

### 결정
**SQLite** 선택

### 이유
1. **즉시 개발**: 추가 설정 없이 바로 개발 가능
2. **Prisma 호환**: Prisma가 SQLite 완벽 지원
3. **배포 시 전환 용이**: schema.prisma만 수정하면 PostgreSQL로 전환

### 변경 사항
- `prisma/schema.prisma`: provider를 "sqlite"로 변경
- `.env`: DATABASE_URL을 "file:./dev.db"로 변경
- `@db.VarChar` 등 PostgreSQL 전용 수식어 제거
- `Json` 타입을 `String`으로 변경 (JSON 직렬화)

### 배포 전략
```
개발: SQLite (file:./dev.db)
배포: Supabase PostgreSQL (DATABASE_URL 환경변수)
```

---

## 작성 가이드

### 언제 ADR을 작성하는가?
```
- 기술 스택 선택 (프레임워크, 라이브러리)
- 아키텍처 패턴 결정
- 데이터베이스 설계 결정
- API 설계 방식 결정
- 배포 전략 결정
- 테스트 전략 결정
```

### ADR 템플릿
```markdown
## ADR-XXX: [결정 제목]

### 날짜
YYYY-MM-DD

### 컨텍스트
[상황 설명]

### 고려한 옵션들
- 옵션 A: ...
- 옵션 B: ...

### 결정
[선택한 옵션]

### 이유
[왜 이 옵션을 선택했는지]

### 트레이드오프
[포기한 것, 감수하는 것]
```

---

## 상태 정의

| 상태 | 의미 |
|------|------|
| 제안됨 | 검토 중 |
| 채택 | 결정됨, 적용 중 |
| 거부됨 | 채택하지 않음 |
| 대체됨 | 새 결정으로 대체됨 |
| 폐기됨 | 더 이상 유효하지 않음 |
